export const createCamp = async (title: string, courtCount: number = 6, ownerId?: string) => {
  try {
    console.log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');
    console.log('[createCamp] ğŸš€ æ›¸ãè¾¼ã¿é–‹å§‹');
    console.log('[createCamp]   ã‚¿ã‚¤ãƒˆãƒ«:', title);
    console.log('[createCamp]   ã‚³ãƒ¼ãƒˆæ•°:', courtCount);
    console.log('[createCamp]   ã‚ªãƒ¼ãƒŠãƒ¼UID:', ownerId || '(æœªè¨­å®š)');
    
    const campsRef = collection(db, 'camps');
    const newCampRef = doc(campsRef); // IDã‚’è‡ªå‹•ç”Ÿæˆ

    const newCamp: Camp = {
      id: newCampRef.id,
      title: title,
      court_count: courtCount,
      status: 'setup', // æœ€åˆã¯ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ä¸­
      created_at: serverTimestamp() as any,
      owner_id: ownerId, // ä½œæˆè€…ã®UIDã‚’ä¿å­˜
      config: {
        default_match_points: 15, // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ15ç‚¹
      },
    };

    console.log('[createCamp]   ç”Ÿæˆã•ã‚ŒãŸID:', newCampRef.id);
    console.log('[createCamp]   æ›¸ãè¾¼ã¿ãƒ‡ãƒ¼ã‚¿:', JSON.stringify(newCamp, null, 2));
    console.log('[createCamp] ğŸ“¤ Firebaseã¸ setDoc() å®Ÿè¡Œä¸­...');
    
    // âš ï¸ Task 2: ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ãƒ»ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãªã—ã®ç´ ã®çŠ¶æ…‹ã§å®Ÿè¡Œ
    await setDoc(newCampRef, newCamp);
    
    console.log('[createCamp] âœ… æ›¸ãè¾¼ã¿æˆåŠŸï¼');
    console.log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');
    return newCampRef.id;
  } catch (error: any) {
    // âš ï¸ Task 2: ã‚¨ãƒ©ãƒ¼ã‚’ç”»é¢ã«ãƒ‡ã‚«ãƒ‡ã‚«ã¨è¡¨ç¤º
    const errorCode = error?.code || 'unknown';
    const errorMessage = error?.message || 'ã‚¨ãƒ©ãƒ¼è©³ç´°ä¸æ˜';
    const errorName = error?.name || 'Error';
    
    console.error('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');
    console.error('[createCamp] âŒ æ›¸ãè¾¼ã¿å¤±æ•—ï¼');
    console.error('[createCamp]   ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰:', errorCode);
    console.error('[createCamp]   ã‚¨ãƒ©ãƒ¼å:', errorName);
    console.error('[createCamp]   ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸:', errorMessage);
    console.error('[createCamp]   å®Œå…¨ãªã‚¨ãƒ©ãƒ¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ:', error);
    console.error('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');
    
    // ç”»é¢ã«ãƒ‡ã‚«ãƒ‡ã‚«ã¨alertè¡¨ç¤º
    const alertMessage = `
ğŸ”¥ğŸ”¥ğŸ”¥ FIREBASE æ›¸ãè¾¼ã¿ã‚¨ãƒ©ãƒ¼ ğŸ”¥ğŸ”¥ğŸ”¥

ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰: ${errorCode}
ã‚¨ãƒ©ãƒ¼å: ${errorName}

è©³ç´°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸:
${errorMessage}

---
ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ­ã‚°ã‚‚ç¢ºèªã—ã¦ãã ã•ã„
    `.trim();
    
    alert(alertMessage);
    
    return null;
  }
};
